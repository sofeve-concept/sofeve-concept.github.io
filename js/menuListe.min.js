var appsMenuItems=document.querySelectorAll("#menuListe > li"),currentIndex,subIndex,subMenuItems=document.querySelectorAll("#menuListe > li li"),keys={tab:9,enter:13,esc:27,space:32,left:37,up:38,right:39,down:40},gotoIndex=function(e){e==appsMenuItems.length?e=0:e<0&&(e=appsMenuItems.length-1),appsMenuItems[e].focus(),currentIndex=e},gotoSubIndex=function(e,t){var n=e.querySelectorAll("li");t==n.length?t=0:t<0&&(t=n.length-1),n[t].focus(),subIndex=t};Array.prototype.forEach.call(appsMenuItems,function(e,t){0==t?(e.setAttribute("tabindex","0"),e.addEventListener("focus",function(){currentIndex=0})):e.setAttribute("tabindex","-1"),e.addEventListener("focus",function(){subIndex=0,Array.prototype.forEach.call(appsMenuItems,function(e){e.setAttribute("aria-expanded","false")})}),e.addEventListener("click",function(e){return this.getAttribute("aria-expanded")=="false"||this.getAttribute("aria-expanded")==null?this.setAttribute("aria-expanded","true"):this.setAttribute("aria-expanded","false"),e.preventDefault(),!1}),e.addEventListener("keydown",function(e){var n,t=!1;switch(e.keyCode){case keys.right:gotoIndex(currentIndex+1),t=!0;break;case keys.left:gotoIndex(currentIndex-1),t=!0;break;case keys.tab:gotoIndex(e.shiftKey?currentIndex-1:currentIndex+1),t=!0;break;case keys.enter:case keys.down:this.click(),subindex=0,gotoSubIndex(this.querySelector("ul"),0),t=!0;break;case keys.up:this.click(),n=this.querySelector("ul"),subindex=n.querySelectorAll("li").length-1,gotoSubIndex(n,subindex),t=!0;break;case keys.esc:document.querySelector("#escape").setAttribute("tabindex","-1"),document.querySelector("#escape").focus(),t=!0}t&&e.preventDefault()})}),Array.prototype.forEach.call(subMenuItems,function(e){e.setAttribute("tabindex","-1"),e.addEventListener("keydown",function(e){switch(e.keyCode){case keys.tab:gotoIndex(e.shiftKey?currentIndex-1:currentIndex+1),prevdef=!0;break;case keys.right:gotoIndex(currentIndex+1),prevdef=!0;break;case keys.left:gotoIndex(currentIndex-1),prevdef=!0;break;case keys.esc:gotoIndex(currentIndex),prevdef=!0;break;case keys.down:gotoSubIndex(this.parentNode,subIndex+1),prevdef=!0;break;case keys.up:gotoSubIndex(this.parentNode,subIndex-1),prevdef=!0;break;case keys.enter:case keys.space:alert(this.innerText),prevdef=!0;break}return prevdef&&(e.preventDefault(),e.stopPropagation()),!1}),e.addEventListener("click",function(e){return alert(this.innerHTML),e.preventDefault(),e.stopPropagation(),!1})})