<!DOCTYPE html>
<html lang="fr-FR">
	<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	
	
	
	<title>Fenêtre modale - Composants web - Sofève Concept</title>
	<meta name="description" content="Extrait de code pour une fenêtre modale accessible au clavier.">
	<meta name="author" content="Sophie Gounon">
	<meta property="og:locale" content="fr_FR" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Sofève Concept" />
    <meta property="og:description"
        content="Sofève Concept est un site web de conseil et de documentation pour créer des sites web accessibles" />
    <meta property="og:url" content="https://sofeve-concept.github.io" />
    <meta property="og:site_name" content="Sofève Concept" />
    <meta property="og:image" content="https://sofeve-concept.github.io/images/sofeve-concept.jpg" />
	<link href="/images/favicon.ico" rel="icon">
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Gabriela&family=Poppins&family=Righteous&display=swap" rel="stylesheet">
	<link rel="stylesheet" href="/css/print.css" media="print">
	<link rel="stylesheet" href="/css/fontawesome.css">
	<link rel="stylesheet" href="/css/sofeve.css" media="screen">
		
	
	<link rel="stylesheet" href="/css/modale.css" media="screen">
	
	
</head>
<body>
	<a class="evitement" href="#contenu">Aller au contenu</a>
<header role="banner">
	<div class="logo">
		<a href="https://sofeve-concept.github.io">
			<img src="/images/sofeve-concept-logo.png" alt="Sofève Concept" class="big-logo">
			<img src="/images/mini-logo.png" alt="Sofève Concept" class="mini-logo">
		</a>
	</div>
	<nav role='navigation' class="navbar" aria-label="Menu principal">
		<button aria-expanded="false" id="hamburger" aria-controls="menu">
		     <span class="sr-only">Menu</span>
		</button>
		<ul id="menu">
		
		
		 
			
			<li  class="accueil">
				<a href="/" 
				
				
				> Accueil</a></li>
			
		
		 
				
			<li class="coder">
				<button aria-haspopup="true" aria-expanded="false" aria-controls="coder" 
				
				> 
				Web accessible</button>
				   <ul id="coder">
					 		
					
					
										
              				<li><a href="/coder/" 
							
							> Vue d&#39;ensemble</a></li>
              			 		
					
					
										
              				<li><a href="/coder/structure/" 
							
							> Structure générale</a></li>
              			 		
					
					
										
              				<li><a href="/coder/contenu/" 
							
							> Contenu</a></li>
              			 		
					
					
										
              				<li><a href="/coder/couleurs/" 
							
							> Couleurs</a></li>
              			 		
					
					
										
              				<li><a href="/coder/navigation/" 
							
							> Navigation</a></li>
              			 		
					
					
										
              				<li><a href="/coder/lien-bouton/" 
							
							> Liens et boutons</a></li>
              			 		
					
					
										
              				<li><a href="/coder/image-icone/" 
							
							> Images et icônes</a></li>
              			 		
					
					
										
              				<li><a href="/coder/tableaux/" 
							
							> Tableaux</a></li>
              			 		
					
					
										
              				<li><a href="/coder/formulaire/" 
							
							> Formulaires</a></li>
              			 		
					
					
										
              				<li><a href="/coder/scripts/" 
							
							> Composants d&#39;interface riche</a></li>
              			
				   </ul>
			    </li>
			
		
		 
			
			<li  class="motifs">
				<a href="/motifs/" 
				
				aria-current="page"
				> Composants web</a></li>
			
		
		 
				
			<li class="bureautique">
				<button aria-haspopup="true" aria-expanded="false" aria-controls="bureautique" 
				
				> 
				Bureautique accessible</button>
				   <ul id="bureautique">
					 		
					
					
										
              				<li><a href="/bureautique/" 
							
							> Introduction</a></li>
              			 		
					
					
										
              				<li><a href="/bureautique/structure/" 
							
							> Structure du document</a></li>
              			 		
					
					
										
              				<li><a href="/bureautique/presentation/" 
							
							> Présentaton du texte</a></li>
              			 		
					
					
										
              				<li><a href="/bureautique/liens/" 
							
							> Lien hypertexte</a></li>
              			 		
					
					
										
              				<li><a href="/bureautique/images/" 
							
							> Image</a></li>
              			 		
					
					
										
              				<li><a href="/bureautique/couleur/" 
							
							> Couleur et contraste</a></li>
              			 		
					
					
										
              				<li><a href="/bureautique/finaliser/" 
							
							> Tags et export PDF</a></li>
              			
				   </ul>
			    </li>
			
		
		</ul>
	</nav>	
	<form action="/rechercher" method="GET" role="search" class="search">
    <div class="champs">
    <label for="search-query">Rechercher</label>
    <input type="search" name="q" id="search-query" >
    </div>
    <button type="reset">
        <span class="fa fa-times" aria-hidden="true"></span>
        <span class="sr-only">Effacer</span>
    </button>
    <button type="submit">
        <span class="fa fa-search" aria-hidden="true"></span>
        <span class="sr-only">Rechercher</span>
    </button>
</form>
<div class="toSearch">
    <a href="/rechercher"><i class="fa fa-search" aria-label="Aller à la recherche surt le site"></i></a>
</div>


</header>

	
<main role="main" class="container">
     <div class="flex ligneHaut">
<nav aria-label="Vous êtes ici" class="ariane">
<ol>
  
  
    
  
    
  
  
  <li>
    
    <a href="/">Accueil</a>
   
  </li>
  

  
  
  <li>
    
    <a href="/motifs/">Composants web</a>
   
  </li>
  

  
  
  <li aria-current="page" tabindex="-1">
    Fenêtre modale
  </li>
  

</ol>
</nav>
<div>
<button onclick="window.print();">
  <span class="fa fa-print" aria-hidden="true"></span>
  Imprimer
</button>
</div>
</div>


     <div class="flex">
          <aside class="item-20">
               
               

	
	
     
	<nav role="navigation" aria-label="navigation contextuelle">
          <p class="rubrique">Motifs de conception</p>
          <button aria-haspopup="true" aria-expanded="false" id="sandwitch" aria-controls="sousMenu">
               <i class="fa fa-bars" aria-hidden="true"></i>
               <span class="sr-only">Menu</span>
          </button>
          <ul>
               
               <li><a href="/motifs/code-de-base/">
                    
				
				 Code de base 
               </a></li>
               
               <li><a href="/motifs/accordeon/">
                    
				
				Accordéon 
               </a></li>
               
               <li><a href="/motifs/bordure-texte/">
                    
				
				Bordure de texte 
               </a></li>
               
               <li><a href="/motifs/carrousel/">
                    
				
				Carrousel 
               </a></li>
               
               <li><a href="/motifs/carte-cliquable/">
                    
				
				Carte cliquable 
               </a></li>
               
               <li><a href="/motifs/modale/">
                    
				 <strong>Fenêtre modale</strong> 
               </a></li>
               
               <li><a href="/motifs/ariane/">
                    
				
				Fil d&#39;ariane 
               </a></li>
               
               <li><a href="/motifs/infobulle/">
                    
				
				Infobulle 
               </a></li>
               
               <li><a href="/motifs/lien-evitement/">
                    
				
				Lien d&#39;évitement 
               </a></li>
               
               <li><a href="/motifs/menu-de-navigation/">
                    
				
				Menu de navigation 
               </a></li>
               
               <li><a href="/motifs/menu-lateral-glissant/">
                    
				
				Menu latéral glissant 
               </a></li>
               
               <li><a href="/motifs/onglets/">
                    
				
				Onglets 
               </a></li>
               
               <li><a href="/motifs/placeholder/">
                    
				
				Placeholder 
               </a></li>
               
               <li><a href="/motifs/stepper/">
                    
				
				Processus par étape 
               </a></li>
               
               <li><a href="/motifs/tableau-responsive/">
                    
				
				Tableau 
               </a></li>
               
          </ul>


		
	</nav>

               
          </aside>
          <section class="item-80 rubMotif">
               <h1>Fenêtre modale</h1>
               <p>Extrait de code pour une fenêtre modale accessible au clavier.</p>
               <div class="toc">
                    <h2>Dans cette rubrique</h2>
                    <nav id="TableOfContents">
  <ul>
    <li><a href="#visuel">Visuel</a>
      <ul>
        <li><a href="#règles-dimplémentation">Règles d&rsquo;implémentation</a></li>
      </ul>
    </li>
    <li><a href="#extraits-de-code">Extraits de code</a>
      <ul>
        <li><a href="#code-html">Code HTML</a></li>
        <li><a href="#code-css">Code CSS</a></li>
        <li><a href="#code-javascript">Code javascript</a></li>
      </ul>
    </li>
  </ul>
</nav>
               </div>

               <h2 id="visuel">Visuel</h2>

<button type="button" onclick="openDialog('dialog1', this)">Ouvrir la fenêtre modale</button>
<!-- La fenêtre Modale -->
    <div role="dialog"
         id="dialog1"
         aria-labelledby="dialog1_label"
         aria-modal="true"
         class="none">
         <div class="dialog-header">
      <h1 id="dialog1_label">Titre de la fenêtre modale</h1>
      <button type="button" aria-label="Fermer" title="Fermer la fenêtre modale" onclick="closeDialog(this)">&times;</button>
    </div>
      <div class="dialog-body">
        <p>Labore sit invidunt amet sit sanctus justo tempor sea amet, accusam nonumy et et nonumy aliquyam dolor ipsum vero duo.</p>
    <p>Erat clita accusam sed nonumy, sadipscing no labore sadipscing accusam. Ut diam ea dolor consetetur sed et dolor magna. </p><p>Sit rebum amet et kasd no consetetur no. Et et amet labore ea eos ea no gubergren ipsum, dolores diam invidunt aliquyam erat, et sit sea diam diam gubergren tempor. Erat stet sit dolore et voluptua erat ipsum consetetur. Vero eos.</p>
      </div>
      <div class="dialog-footer">
        <button type="button" onclick="closeDialog(this)">Fermer</button>
      </div>
    </div>

<h3 id="règles-dimplémentation">Règles d&rsquo;implémentation</h3>
<ul>
<li>Une fenêtre modale est considéré comme un changement de contexte. On veillera donc à commencer son contenu par un titre de niveau 1 (élément HTML <code>h1</code>).</li>
<li>Pour bien signifier l&rsquo;ouverture d&rsquo;un nouveau contexte, on veillera à opacifier le fond de la page pour bien faire apparaître la fenêtre modale.</li>
<li>À l&rsquo;ouverture de la fenêtre modale, le focus sera positionné sur le bouton de fermeture qui sera le premier élément HTML de la fenêtre.</li>
<li>La fenêtre modale pourra être fermée en appuyant sur la touche [Echap].</li>
</ul>
<h2 id="extraits-de-code">Extraits de code</h2>
<h3 id="code-html">Code HTML</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;button&#34;</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&#34;openDialog(&#39;dialog1&#39;, this)&#34;</span><span class="p">&gt;</span>Ouvrir la fenêtre modale<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c">&lt;!-- La fenêtre Modale --&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">role</span><span class="o">=</span><span class="s">&#34;dialog&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">id</span><span class="o">=</span><span class="s">&#34;dialog1&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">aria-labelledby</span><span class="o">=</span><span class="s">&#34;dialog1_label&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">aria-modal</span><span class="o">=</span><span class="s">&#34;true&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">class</span><span class="o">=</span><span class="s">&#34;none&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">         <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;dialog-header&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">h1</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;dialog1_label&#34;</span><span class="p">&gt;</span>Titre de la fenêtre modale<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;button&#34;</span> <span class="na">aria-label</span><span class="o">=</span><span class="s">&#34;Fermer&#34;</span> <span class="na">title</span><span class="o">=</span><span class="s">&#34;Fermer la fenêtre modale&#34;</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&#34;closeDialog(this)&#34;</span><span class="p">&gt;</span><span class="ni">&amp;times;</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;dialog-body&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Labore sit invidunt amet sit sanctus justo tempor sea amet, accusam nonumy et et nonumy aliquyam dolor ipsum vero duo.<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Erat clita accusam sed nonumy, sadipscing no labore sadipscing accusam. Ut diam ea dolor consetetur sed et dolor magna. <span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Sit rebum amet et kasd no consetetur no. Et et amet labore ea eos ea no gubergren ipsum, dolores diam invidunt aliquyam erat, et sit sea diam diam gubergren tempor. Erat stet sit dolore et voluptua erat ipsum consetetur. Vero eos.<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;dialog-footer&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;button&#34;</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&#34;closeDialog(this)&#34;</span><span class="p">&gt;</span>Fermer<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span></code></pre></div><h3 id="code-css">Code CSS</h3>
<p>Pour adapter les couleurs, modifier les codes couleurs dans la déclaration <code>:root</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-css" data-lang="css"><span class="line"><span class="cl"><span class="c">/** Modale **/</span>
</span></span><span class="line"><span class="cl"><span class="p">:</span><span class="nd">root</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">--BORDER-color</span><span class="p">:</span> <span class="mh">#b0aeae</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">--BACKGROUND-color</span><span class="p">:</span> <span class="mh">#FFFFFF</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">--BODY-FADE-color</span><span class="p">:</span> <span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">--BOX-SHADOW</span><span class="p">:</span> <span class="mi">0</span> <span class="mi">19</span><span class="kt">px</span> <span class="mi">38</span><span class="kt">px</span> <span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">),</span> <span class="mi">0</span> <span class="mi">15</span><span class="kt">px</span> <span class="mi">12</span><span class="kt">px</span> <span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.22</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">--FOCUS-color</span><span class="p">:</span> <span class="mh">#252d91</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nc">none</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">display</span><span class="p">:</span> <span class="kc">none</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span><span class="nt">role</span><span class="o">=</span><span class="s2">&#34;alertdialog&#34;</span><span class="o">],</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span><span class="nt">role</span><span class="o">=</span><span class="s2">&#34;dialog&#34;</span><span class="o">]</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">box-sizing</span><span class="p">:</span> <span class="kc">border-box</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">padding</span><span class="p">:</span> <span class="mi">1</span><span class="kt">em</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">border</span><span class="p">:</span> <span class="mi">1</span><span class="kt">px</span> <span class="kc">solid</span> <span class="nf">var</span><span class="p">(</span><span class="o">--</span><span class="n">BORDER</span><span class="o">-</span><span class="kc">color</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">background-color</span><span class="p">:</span> <span class="nf">var</span><span class="p">(</span><span class="o">--</span><span class="n">BACKGROUND</span><span class="o">-</span><span class="kc">color</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">min-height</span><span class="p">:</span> <span class="mi">100</span><span class="kt">vh</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">z-index</span><span class="p">:</span> <span class="mi">1030</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span><span class="nt">role</span><span class="o">=</span><span class="s2">&#34;dialog&#34;</span><span class="o">]</span> <span class="o">*</span><span class="p">:</span><span class="nd">focus</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">outline</span><span class="p">:</span> <span class="mi">3</span><span class="kt">px</span> <span class="kc">solid</span> <span class="nf">var</span><span class="p">(</span><span class="o">--</span><span class="n">FOCUS</span><span class="o">-</span><span class="kc">color</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">@</span><span class="k">media</span> <span class="nt">screen</span> <span class="nt">and</span> <span class="o">(</span><span class="nt">min-width</span><span class="o">:</span> <span class="nt">640px</span><span class="o">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="o">[</span><span class="nt">role</span><span class="o">=</span><span class="s2">&#34;alertdialog&#34;</span><span class="o">],</span>
</span></span><span class="line"><span class="cl">    <span class="o">[</span><span class="nt">role</span><span class="o">=</span><span class="s2">&#34;dialog&#34;</span><span class="o">]</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">position</span><span class="p">:</span> <span class="kc">absolute</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">top</span><span class="p">:</span> <span class="mi">6</span><span class="kt">rem</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">left</span><span class="p">:</span> <span class="mi">50</span><span class="kt">vw</span><span class="p">;</span> <span class="c">/* move to the middle of the screen (assumes relative parent is the body/viewport) */</span>
</span></span><span class="line"><span class="cl">        <span class="k">transform</span><span class="p">:</span> <span class="nb">translateX</span><span class="p">(</span><span class="mi">-50</span><span class="kt">%</span><span class="p">);</span> <span class="c">/* move backwards 50% of this element&#39;s width */</span>
</span></span><span class="line"><span class="cl">        <span class="k">min-width</span><span class="p">:</span> <span class="nb">calc</span><span class="p">(</span><span class="mi">640</span><span class="kt">px</span> <span class="o">-</span> <span class="p">(</span><span class="mi">15</span><span class="kt">px</span> <span class="o">*</span> <span class="mi">2</span><span class="p">));</span> <span class="c">/* == breakpoint - left+right margin */</span>
</span></span><span class="line"><span class="cl">        <span class="k">min-height</span><span class="p">:</span> <span class="kc">auto</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">box-shadow</span><span class="p">:</span> <span class="nf">var</span><span class="p">(</span><span class="o">-</span><span class="n">BOX</span><span class="o">-</span><span class="n">SHADOW</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nc">dialog-header</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">border-bottom</span><span class="p">:</span> <span class="mi">1</span><span class="kt">px</span> <span class="kc">solid</span> <span class="nf">var</span><span class="p">(</span><span class="o">--</span><span class="n">BORDER</span><span class="o">-</span><span class="kc">color</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">padding-bottom</span><span class="p">:</span> <span class="mf">1.5</span><span class="kt">em</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nc">dialog-header</span> <span class="nt">h1</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">font-size</span><span class="p">:</span> <span class="mf">1.5</span><span class="kt">em</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">margin</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nc">dialog-header</span> <span class="nt">button</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">float</span><span class="p">:</span> <span class="kc">right</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">position</span><span class="p">:</span> <span class="kc">absolute</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">top</span><span class="p">:</span> <span class="mf">1.2</span><span class="kt">em</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">right</span><span class="p">:</span> <span class="mi">2</span><span class="kt">%</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">padding</span><span class="p">:</span> <span class="mf">0.5</span><span class="kt">em</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nc">dialog-body</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">padding</span><span class="p">:</span> <span class="mf">1.5</span><span class="kt">em</span> <span class="mf">0.5</span><span class="kt">em</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nc">dialog-footer</span> <span class="nt">button</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">float</span><span class="p">:</span> <span class="kc">right</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">padding</span><span class="p">:</span> <span class="mf">0.5</span><span class="kt">em</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c">/* native &lt;dialog&gt; element uses the ::backdrop pseudo-element */</span>
</span></span><span class="line"><span class="cl"><span class="c">/* dialog::backdrop, */</span>
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nc">dialog-backdrop</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">display</span><span class="p">:</span> <span class="kc">none</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">position</span><span class="p">:</span> <span class="kc">fixed</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">overflow-y</span><span class="p">:</span> <span class="kc">auto</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">top</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">right</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">bottom</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">left</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">@</span><span class="k">media</span> <span class="nt">screen</span> <span class="nt">and</span> <span class="o">(</span><span class="nt">min-width</span><span class="o">:</span> <span class="nt">640px</span><span class="o">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nc">dialog-backdrop</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">background</span><span class="p">:</span> <span class="nf">var</span><span class="p">(</span><span class="o">--</span><span class="n">BODY</span><span class="o">-</span><span class="n">FADE</span><span class="o">-</span><span class="kc">color</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nc">dialog-backdrop</span><span class="p">.</span><span class="nc">active</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">display</span><span class="p">:</span> <span class="kc">block</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nc">no-scroll</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">overflow-y</span><span class="p">:</span> <span class="kc">auto</span> <span class="cp">!important</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="c">/* this is added to the body when a dialog is open */</span>
</span></span><span class="line"><span class="cl"><span class="p">.</span><span class="nc">has-dialog</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">overflow</span><span class="p">:</span> <span class="kc">hidden</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="code-javascript">Code javascript</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="cl"><span class="cm"> *   This content is licensed according to the W3C Software License at
</span></span></span><span class="line"><span class="cl"><span class="cm"> *   https://www.w3.org/Consortium/Legal/2015/copyright-software-and-document
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s1">&#39;use strict&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">aria</span> <span class="o">=</span> <span class="nx">aria</span> <span class="o">||</span> <span class="p">{};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">aria</span><span class="p">.</span><span class="nx">Utils</span> <span class="o">=</span> <span class="nx">aria</span><span class="p">.</span><span class="nx">Utils</span> <span class="o">||</span> <span class="p">{};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="cm">/*
</span></span></span><span class="line"><span class="cl"><span class="cm">   * When util functions move focus around, set this true so the focus listener
</span></span></span><span class="line"><span class="cl"><span class="cm">   * can ignore the events.
</span></span></span><span class="line"><span class="cl"><span class="cm">   */</span>
</span></span><span class="line"><span class="cl">  <span class="nx">aria</span><span class="p">.</span><span class="nx">Utils</span><span class="p">.</span><span class="nx">IgnoreUtilFocusChanges</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">aria</span><span class="p">.</span><span class="nx">Utils</span><span class="p">.</span><span class="nx">dialogOpenClass</span> <span class="o">=</span> <span class="s1">&#39;has-dialog&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">   * @description Set focus on descendant nodes until the first focusable element is
</span></span></span><span class="line"><span class="cl"><span class="cm">   *       found.
</span></span></span><span class="line"><span class="cl"><span class="cm">   * @param element
</span></span></span><span class="line"><span class="cl"><span class="cm">   *          DOM node for which to find the first focusable descendant.
</span></span></span><span class="line"><span class="cl"><span class="cm">   * @returns {boolean}
</span></span></span><span class="line"><span class="cl"><span class="cm">   *  true if a focusable element is found and focus is set.
</span></span></span><span class="line"><span class="cl"><span class="cm">   */</span>
</span></span><span class="line"><span class="cl">  <span class="nx">aria</span><span class="p">.</span><span class="nx">Utils</span><span class="p">.</span><span class="nx">focusFirstDescendant</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">element</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">element</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="kd">var</span> <span class="nx">child</span> <span class="o">=</span> <span class="nx">element</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="nx">aria</span><span class="p">.</span><span class="nx">Utils</span><span class="p">.</span><span class="nx">attemptFocus</span><span class="p">(</span><span class="nx">child</span><span class="p">)</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">        <span class="nx">aria</span><span class="p">.</span><span class="nx">Utils</span><span class="p">.</span><span class="nx">focusFirstDescendant</span><span class="p">(</span><span class="nx">child</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span> <span class="c1">// end focusFirstDescendant
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">   * @description Find the last descendant node that is focusable.
</span></span></span><span class="line"><span class="cl"><span class="cm">   * @param element
</span></span></span><span class="line"><span class="cl"><span class="cm">   *          DOM node for which to find the last focusable descendant.
</span></span></span><span class="line"><span class="cl"><span class="cm">   * @returns {boolean}
</span></span></span><span class="line"><span class="cl"><span class="cm">   *  true if a focusable element is found and focus is set.
</span></span></span><span class="line"><span class="cl"><span class="cm">   */</span>
</span></span><span class="line"><span class="cl">  <span class="nx">aria</span><span class="p">.</span><span class="nx">Utils</span><span class="p">.</span><span class="nx">focusLastDescendant</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">element</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="nx">element</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="kd">var</span> <span class="nx">child</span> <span class="o">=</span> <span class="nx">element</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="nx">aria</span><span class="p">.</span><span class="nx">Utils</span><span class="p">.</span><span class="nx">attemptFocus</span><span class="p">(</span><span class="nx">child</span><span class="p">)</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">        <span class="nx">aria</span><span class="p">.</span><span class="nx">Utils</span><span class="p">.</span><span class="nx">focusLastDescendant</span><span class="p">(</span><span class="nx">child</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span> <span class="c1">// end focusLastDescendant
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">   * @description Set Attempt to set focus on the current node.
</span></span></span><span class="line"><span class="cl"><span class="cm">   * @param element
</span></span></span><span class="line"><span class="cl"><span class="cm">   *          The node to attempt to focus on.
</span></span></span><span class="line"><span class="cl"><span class="cm">   * @returns {boolean}
</span></span></span><span class="line"><span class="cl"><span class="cm">   *  true if element is focused.
</span></span></span><span class="line"><span class="cl"><span class="cm">   */</span>
</span></span><span class="line"><span class="cl">  <span class="nx">aria</span><span class="p">.</span><span class="nx">Utils</span><span class="p">.</span><span class="nx">attemptFocus</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">element</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">aria</span><span class="p">.</span><span class="nx">Utils</span><span class="p">.</span><span class="nx">isFocusable</span><span class="p">(</span><span class="nx">element</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nx">aria</span><span class="p">.</span><span class="nx">Utils</span><span class="p">.</span><span class="nx">IgnoreUtilFocusChanges</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">element</span><span class="p">.</span><span class="nx">focus</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// continue regardless of error
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nx">aria</span><span class="p">.</span><span class="nx">Utils</span><span class="p">.</span><span class="nx">IgnoreUtilFocusChanges</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">document</span><span class="p">.</span><span class="nx">activeElement</span> <span class="o">===</span> <span class="nx">element</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span> <span class="c1">// end attemptFocus
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="cm">/* Modals can open modals. Keep track of them with this array. */</span>
</span></span><span class="line"><span class="cl">  <span class="nx">aria</span><span class="p">.</span><span class="nx">OpenDialogList</span> <span class="o">=</span> <span class="nx">aria</span><span class="p">.</span><span class="nx">OpenDialogList</span> <span class="o">||</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">   * @returns {object} the last opened dialog (the current dialog)
</span></span></span><span class="line"><span class="cl"><span class="cm">   */</span>
</span></span><span class="line"><span class="cl">  <span class="nx">aria</span><span class="p">.</span><span class="nx">getCurrentDialog</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">aria</span><span class="p">.</span><span class="nx">OpenDialogList</span> <span class="o">&amp;&amp;</span> <span class="nx">aria</span><span class="p">.</span><span class="nx">OpenDialogList</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="nx">aria</span><span class="p">.</span><span class="nx">OpenDialogList</span><span class="p">[</span><span class="nx">aria</span><span class="p">.</span><span class="nx">OpenDialogList</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">aria</span><span class="p">.</span><span class="nx">closeCurrentDialog</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">currentDialog</span> <span class="o">=</span> <span class="nx">aria</span><span class="p">.</span><span class="nx">getCurrentDialog</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">currentDialog</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">currentDialog</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">aria</span><span class="p">.</span><span class="nx">handleEscape</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">key</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">which</span> <span class="o">||</span> <span class="nx">event</span><span class="p">.</span><span class="nx">keyCode</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">key</span> <span class="o">===</span> <span class="nx">aria</span><span class="p">.</span><span class="nx">KeyCode</span><span class="p">.</span><span class="nx">ESC</span> <span class="o">&amp;&amp;</span> <span class="nx">aria</span><span class="p">.</span><span class="nx">closeCurrentDialog</span><span class="p">())</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">event</span><span class="p">.</span><span class="nx">stopPropagation</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;keyup&#39;</span><span class="p">,</span> <span class="nx">aria</span><span class="p">.</span><span class="nx">handleEscape</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">   * @class
</span></span></span><span class="line"><span class="cl"><span class="cm">   * @description Dialog object providing modal focus management.
</span></span></span><span class="line"><span class="cl"><span class="cm">   *
</span></span></span><span class="line"><span class="cl"><span class="cm">   * Assumptions: The element serving as the dialog container is present in the
</span></span></span><span class="line"><span class="cl"><span class="cm">   * DOM and hidden. The dialog container has role=&#39;dialog&#39;.
</span></span></span><span class="line"><span class="cl"><span class="cm">   *
</span></span></span><span class="line"><span class="cl"><span class="cm">   * @param dialogId
</span></span></span><span class="line"><span class="cl"><span class="cm">   *          The ID of the element serving as the dialog container.
</span></span></span><span class="line"><span class="cl"><span class="cm">   * @param focusAfterClosed
</span></span></span><span class="line"><span class="cl"><span class="cm">   *          Either the DOM node or the ID of the DOM node to focus when the
</span></span></span><span class="line"><span class="cl"><span class="cm">   *          dialog closes.
</span></span></span><span class="line"><span class="cl"><span class="cm">   * @param focusFirst
</span></span></span><span class="line"><span class="cl"><span class="cm">   *          Optional parameter containing either the DOM node or the ID of the
</span></span></span><span class="line"><span class="cl"><span class="cm">   *          DOM node to focus when the dialog opens. If not specified, the
</span></span></span><span class="line"><span class="cl"><span class="cm">   *          first focusable element in the dialog will receive focus.
</span></span></span><span class="line"><span class="cl"><span class="cm">   */</span>
</span></span><span class="line"><span class="cl">  <span class="nx">aria</span><span class="p">.</span><span class="nx">Dialog</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">dialogId</span><span class="p">,</span> <span class="nx">focusAfterClosed</span><span class="p">,</span> <span class="nx">focusFirst</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="p">.</span><span class="nx">dialogNode</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">dialogId</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">dialogNode</span> <span class="o">===</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;No element found with id=&#34;&#39;</span> <span class="o">+</span> <span class="nx">dialogId</span> <span class="o">+</span> <span class="s1">&#39;&#34;.&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">validRoles</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dialog&#39;</span><span class="p">,</span> <span class="s1">&#39;alertdialog&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">isDialog</span> <span class="o">=</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">dialogNode</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;role&#39;</span><span class="p">)</span> <span class="o">||</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">.</span><span class="nx">trim</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">      <span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="sr">/\s+/g</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">.</span><span class="nx">some</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">token</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">validRoles</span><span class="p">.</span><span class="nx">some</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">role</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="k">return</span> <span class="nx">token</span> <span class="o">===</span> <span class="nx">role</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">});</span>
</span></span><span class="line"><span class="cl">      <span class="p">});</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">isDialog</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;Dialog() requires a DOM element with ARIA role of dialog or alertdialog.&#39;</span>
</span></span><span class="line"><span class="cl">      <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Wrap in an individual backdrop element if one doesn&#39;t exist
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// Native &lt;dialog&gt; elements use the ::backdrop pseudo-element, which
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// works similarly.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kd">var</span> <span class="nx">backdropClass</span> <span class="o">=</span> <span class="s1">&#39;dialog-backdrop&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">dialogNode</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="nx">backdropClass</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">this</span><span class="p">.</span><span class="nx">backdropNode</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">dialogNode</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">this</span><span class="p">.</span><span class="nx">backdropNode</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">this</span><span class="p">.</span><span class="nx">backdropNode</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="nx">backdropClass</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="k">this</span><span class="p">.</span><span class="nx">dialogNode</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">backdropNode</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">dialogNode</span>
</span></span><span class="line"><span class="cl">      <span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">this</span><span class="p">.</span><span class="nx">backdropNode</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">dialogNode</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="p">.</span><span class="nx">backdropNode</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">&#39;active&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Disable scroll on the body element
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="nx">aria</span><span class="p">.</span><span class="nx">Utils</span><span class="p">.</span><span class="nx">dialogOpenClass</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">focusAfterClosed</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">this</span><span class="p">.</span><span class="nx">focusAfterClosed</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">focusAfterClosed</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">focusAfterClosed</span> <span class="o">===</span> <span class="s1">&#39;object&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">this</span><span class="p">.</span><span class="nx">focusAfterClosed</span> <span class="o">=</span> <span class="nx">focusAfterClosed</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;the focusAfterClosed parameter is required for the aria.Dialog constructor.&#39;</span>
</span></span><span class="line"><span class="cl">      <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">focusFirst</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">this</span><span class="p">.</span><span class="nx">focusFirst</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">focusFirst</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">focusFirst</span> <span class="o">===</span> <span class="s1">&#39;object&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">this</span><span class="p">.</span><span class="nx">focusFirst</span> <span class="o">=</span> <span class="nx">focusFirst</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">this</span><span class="p">.</span><span class="nx">focusFirst</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// Bracket the dialog node with two invisible, focusable nodes.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// While this dialog is open, we use these to make sure that focus never
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// leaves the document even if dialogNode is the first or last node.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kd">var</span> <span class="nx">preDiv</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="p">.</span><span class="nx">preNode</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">dialogNode</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="nx">preDiv</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="k">this</span><span class="p">.</span><span class="nx">dialogNode</span>
</span></span><span class="line"><span class="cl">    <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="p">.</span><span class="nx">preNode</span><span class="p">.</span><span class="nx">tabIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">postDiv</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="p">.</span><span class="nx">postNode</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">dialogNode</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">insertBefore</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="nx">postDiv</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="k">this</span><span class="p">.</span><span class="nx">dialogNode</span><span class="p">.</span><span class="nx">nextSibling</span>
</span></span><span class="line"><span class="cl">    <span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="p">.</span><span class="nx">postNode</span><span class="p">.</span><span class="nx">tabIndex</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// If this modal is opening on top of one that is already open,
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// get rid of the document focus listener of the open dialog.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span> <span class="p">(</span><span class="nx">aria</span><span class="p">.</span><span class="nx">OpenDialogList</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">aria</span><span class="p">.</span><span class="nx">getCurrentDialog</span><span class="p">().</span><span class="nx">removeListeners</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="p">.</span><span class="nx">addListeners</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="nx">aria</span><span class="p">.</span><span class="nx">OpenDialogList</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="p">.</span><span class="nx">clearDialog</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="p">.</span><span class="nx">dialogNode</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="s1">&#39;default_dialog&#39;</span><span class="p">;</span> <span class="c1">// make visible
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">focusFirst</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">this</span><span class="p">.</span><span class="nx">focusFirst</span><span class="p">.</span><span class="nx">focus</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">aria</span><span class="p">.</span><span class="nx">Utils</span><span class="p">.</span><span class="nx">focusFirstDescendant</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">dialogNode</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="p">.</span><span class="nx">lastFocus</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">activeElement</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span> <span class="c1">// end Dialog constructor
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="nx">aria</span><span class="p">.</span><span class="nx">Dialog</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">clearDialog</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">map</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="k">this</span><span class="p">.</span><span class="nx">dialogNode</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">      <span class="kd">function</span> <span class="p">(</span><span class="nx">input</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">input</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">   * @description
</span></span></span><span class="line"><span class="cl"><span class="cm">   *  Hides the current top dialog,
</span></span></span><span class="line"><span class="cl"><span class="cm">   *  removes listeners of the top dialog,
</span></span></span><span class="line"><span class="cl"><span class="cm">   *  restore listeners of a parent dialog if one was open under the one that just closed,
</span></span></span><span class="line"><span class="cl"><span class="cm">   *  and sets focus on the element specified for focusAfterClosed.
</span></span></span><span class="line"><span class="cl"><span class="cm">   */</span>
</span></span><span class="line"><span class="cl">  <span class="nx">aria</span><span class="p">.</span><span class="nx">Dialog</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">close</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">aria</span><span class="p">.</span><span class="nx">OpenDialogList</span><span class="p">.</span><span class="nx">pop</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="p">.</span><span class="nx">removeListeners</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="nx">aria</span><span class="p">.</span><span class="nx">Utils</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">preNode</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">aria</span><span class="p">.</span><span class="nx">Utils</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">postNode</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="p">.</span><span class="nx">dialogNode</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="p">.</span><span class="nx">backdropNode</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="s1">&#39;active&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="p">.</span><span class="nx">focusAfterClosed</span><span class="p">.</span><span class="nx">focus</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// If a dialog was open underneath this one, restore its listeners.
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span> <span class="p">(</span><span class="nx">aria</span><span class="p">.</span><span class="nx">OpenDialogList</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">aria</span><span class="p">.</span><span class="nx">getCurrentDialog</span><span class="p">().</span><span class="nx">addListeners</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="nx">aria</span><span class="p">.</span><span class="nx">Utils</span><span class="p">.</span><span class="nx">dialogOpenClass</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span> <span class="c1">// end close
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">   * @description
</span></span></span><span class="line"><span class="cl"><span class="cm">   *  Hides the current dialog and replaces it with another.
</span></span></span><span class="line"><span class="cl"><span class="cm">   *
</span></span></span><span class="line"><span class="cl"><span class="cm">   * @param newDialogId
</span></span></span><span class="line"><span class="cl"><span class="cm">   *  ID of the dialog that will replace the currently open top dialog.
</span></span></span><span class="line"><span class="cl"><span class="cm">   * @param newFocusAfterClosed
</span></span></span><span class="line"><span class="cl"><span class="cm">   *  Optional ID or DOM node specifying where to place focus when the new dialog closes.
</span></span></span><span class="line"><span class="cl"><span class="cm">   *  If not specified, focus will be placed on the element specified by the dialog being replaced.
</span></span></span><span class="line"><span class="cl"><span class="cm">   * @param newFocusFirst
</span></span></span><span class="line"><span class="cl"><span class="cm">   *  Optional ID or DOM node specifying where to place focus in the new dialog when it opens.
</span></span></span><span class="line"><span class="cl"><span class="cm">   *  If not specified, the first focusable element will receive focus.
</span></span></span><span class="line"><span class="cl"><span class="cm">   */</span>
</span></span><span class="line"><span class="cl">  <span class="nx">aria</span><span class="p">.</span><span class="nx">Dialog</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">replace</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="nx">newDialogId</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">newFocusAfterClosed</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">newFocusFirst</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">aria</span><span class="p">.</span><span class="nx">OpenDialogList</span><span class="p">.</span><span class="nx">pop</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="p">.</span><span class="nx">removeListeners</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="nx">aria</span><span class="p">.</span><span class="nx">Utils</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">preNode</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">aria</span><span class="p">.</span><span class="nx">Utils</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">postNode</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="p">.</span><span class="nx">dialogNode</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="s1">&#39;hidden&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="p">.</span><span class="nx">backdropNode</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="s1">&#39;active&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">focusAfterClosed</span> <span class="o">=</span> <span class="nx">newFocusAfterClosed</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">focusAfterClosed</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">new</span> <span class="nx">aria</span><span class="p">.</span><span class="nx">Dialog</span><span class="p">(</span><span class="nx">newDialogId</span><span class="p">,</span> <span class="nx">focusAfterClosed</span><span class="p">,</span> <span class="nx">newFocusFirst</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span> <span class="c1">// end replace
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="nx">aria</span><span class="p">.</span><span class="nx">Dialog</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">addListeners</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;focus&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">trapFocus</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span> <span class="c1">// end addListeners
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="nx">aria</span><span class="p">.</span><span class="nx">Dialog</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">removeListeners</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nb">document</span><span class="p">.</span><span class="nx">removeEventListener</span><span class="p">(</span><span class="s1">&#39;focus&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">trapFocus</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span> <span class="c1">// end removeListeners
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="nx">aria</span><span class="p">.</span><span class="nx">Dialog</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">trapFocus</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">aria</span><span class="p">.</span><span class="nx">Utils</span><span class="p">.</span><span class="nx">IgnoreUtilFocusChanges</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">currentDialog</span> <span class="o">=</span> <span class="nx">aria</span><span class="p">.</span><span class="nx">getCurrentDialog</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">currentDialog</span><span class="p">.</span><span class="nx">dialogNode</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">currentDialog</span><span class="p">.</span><span class="nx">lastFocus</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">aria</span><span class="p">.</span><span class="nx">Utils</span><span class="p">.</span><span class="nx">focusFirstDescendant</span><span class="p">(</span><span class="nx">currentDialog</span><span class="p">.</span><span class="nx">dialogNode</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span><span class="nx">currentDialog</span><span class="p">.</span><span class="nx">lastFocus</span> <span class="o">==</span> <span class="nb">document</span><span class="p">.</span><span class="nx">activeElement</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">aria</span><span class="p">.</span><span class="nx">Utils</span><span class="p">.</span><span class="nx">focusLastDescendant</span><span class="p">(</span><span class="nx">currentDialog</span><span class="p">.</span><span class="nx">dialogNode</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="nx">currentDialog</span><span class="p">.</span><span class="nx">lastFocus</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">activeElement</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span> <span class="c1">// end trapFocus
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="nb">window</span><span class="p">.</span><span class="nx">openDialog</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">dialogId</span><span class="p">,</span> <span class="nx">focusAfterClosed</span><span class="p">,</span> <span class="nx">focusFirst</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">new</span> <span class="nx">aria</span><span class="p">.</span><span class="nx">Dialog</span><span class="p">(</span><span class="nx">dialogId</span><span class="p">,</span> <span class="nx">focusAfterClosed</span><span class="p">,</span> <span class="nx">focusFirst</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">window</span><span class="p">.</span><span class="nx">closeDialog</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">closeButton</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">topDialog</span> <span class="o">=</span> <span class="nx">aria</span><span class="p">.</span><span class="nx">getCurrentDialog</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">topDialog</span><span class="p">.</span><span class="nx">dialogNode</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="nx">closeButton</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">topDialog</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span> <span class="c1">// end closeDialog
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">  <span class="nb">window</span><span class="p">.</span><span class="nx">replaceDialog</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="nx">newDialogId</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">newFocusAfterClosed</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nx">newFocusFirst</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">topDialog</span> <span class="o">=</span> <span class="nx">aria</span><span class="p">.</span><span class="nx">getCurrentDialog</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">topDialog</span><span class="p">.</span><span class="nx">dialogNode</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">activeElement</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">topDialog</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">newDialogId</span><span class="p">,</span> <span class="nx">newFocusAfterClosed</span><span class="p">,</span> <span class="nx">newFocusFirst</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span> <span class="c1">// end replaceDialog
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">})();</span>
</span></span></code></pre></div><p><strong>Vous aurez aussi besoin du fichier utils.js qui permet de gérer les actions au clavier et les rôles aria</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="s1">&#39;use strict&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * @namespace aria
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">var</span> <span class="nx">aria</span> <span class="o">=</span> <span class="nx">aria</span> <span class="o">||</span> <span class="p">{};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * @description
</span></span></span><span class="line"><span class="cl"><span class="cm"> *  Key code constants
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="nx">aria</span><span class="p">.</span><span class="nx">KeyCode</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">BACKSPACE</span><span class="o">:</span> <span class="mi">8</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">TAB</span><span class="o">:</span> <span class="mi">9</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">RETURN</span><span class="o">:</span> <span class="mi">13</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">SHIFT</span><span class="o">:</span> <span class="mi">16</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">ESC</span><span class="o">:</span> <span class="mi">27</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">SPACE</span><span class="o">:</span> <span class="mi">32</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">PAGE_UP</span><span class="o">:</span> <span class="mi">33</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">PAGE_DOWN</span><span class="o">:</span> <span class="mi">34</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">END</span><span class="o">:</span> <span class="mi">35</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">HOME</span><span class="o">:</span> <span class="mi">36</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">LEFT</span><span class="o">:</span> <span class="mi">37</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">UP</span><span class="o">:</span> <span class="mi">38</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">RIGHT</span><span class="o">:</span> <span class="mi">39</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">DOWN</span><span class="o">:</span> <span class="mi">40</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">DELETE</span><span class="o">:</span> <span class="mi">46</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">aria</span><span class="p">.</span><span class="nx">Utils</span> <span class="o">=</span> <span class="nx">aria</span><span class="p">.</span><span class="nx">Utils</span> <span class="o">||</span> <span class="p">{};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Polyfill src https://developer.mozilla.org/en-US/docs/Web/API/Element/matches
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">aria</span><span class="p">.</span><span class="nx">Utils</span><span class="p">.</span><span class="nx">matches</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">selector</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">Element</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">matches</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">Element</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">matches</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">      <span class="nx">Element</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">matchesSelector</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">      <span class="nx">Element</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">mozMatchesSelector</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">      <span class="nx">Element</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">msMatchesSelector</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">      <span class="nx">Element</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">oMatchesSelector</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">      <span class="nx">Element</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">webkitMatchesSelector</span> <span class="o">||</span>
</span></span><span class="line"><span class="cl">      <span class="kd">function</span> <span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kd">var</span> <span class="nx">matches</span> <span class="o">=</span> <span class="nx">element</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="nx">s</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="nx">matches</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="p">(</span><span class="o">--</span><span class="nx">i</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">matches</span><span class="p">.</span><span class="nx">item</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span> <span class="o">!==</span> <span class="k">this</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="c1">// empty
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">i</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">};</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nx">element</span><span class="p">.</span><span class="nx">matches</span><span class="p">(</span><span class="nx">selector</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">aria</span><span class="p">.</span><span class="nx">Utils</span><span class="p">.</span><span class="nx">remove</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nx">item</span><span class="p">.</span><span class="nx">remove</span> <span class="o">&amp;&amp;</span> <span class="k">typeof</span> <span class="nx">item</span><span class="p">.</span><span class="nx">remove</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">item</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="nx">item</span><span class="p">.</span><span class="nx">parentNode</span> <span class="o">&amp;&amp;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">item</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">removeChild</span> <span class="o">&amp;&amp;</span>
</span></span><span class="line"><span class="cl">    <span class="k">typeof</span> <span class="nx">item</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">removeChild</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">item</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">item</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">aria</span><span class="p">.</span><span class="nx">Utils</span><span class="p">.</span><span class="nx">isFocusable</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">element</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nx">element</span><span class="p">.</span><span class="nx">tabIndex</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nx">element</span><span class="p">.</span><span class="nx">disabled</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">switch</span> <span class="p">(</span><span class="nx">element</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="s1">&#39;A&#39;</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="o">!!</span><span class="nx">element</span><span class="p">.</span><span class="nx">href</span> <span class="o">&amp;&amp;</span> <span class="nx">element</span><span class="p">.</span><span class="nx">rel</span> <span class="o">!=</span> <span class="s1">&#39;ignore&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="s1">&#39;INPUT&#39;</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="nx">element</span><span class="p">.</span><span class="nx">type</span> <span class="o">!=</span> <span class="s1">&#39;hidden&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="s1">&#39;BUTTON&#39;</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="s1">&#39;SELECT&#39;</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="s1">&#39;TEXTAREA&#39;</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">default</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">aria</span><span class="p">.</span><span class="nx">Utils</span><span class="p">.</span><span class="nx">getAncestorBySelector</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">selector</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">aria</span><span class="p">.</span><span class="nx">Utils</span><span class="p">.</span><span class="nx">matches</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">selector</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nx">element</span><span class="p">.</span><span class="nx">tagName</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// Element is not inside an element that matches selector
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// Move up the DOM tree until a parent matching the selector is found
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kd">var</span> <span class="nx">currentNode</span> <span class="o">=</span> <span class="nx">element</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="kd">var</span> <span class="nx">ancestor</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">while</span> <span class="p">(</span><span class="nx">ancestor</span> <span class="o">===</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">aria</span><span class="p">.</span><span class="nx">Utils</span><span class="p">.</span><span class="nx">matches</span><span class="p">(</span><span class="nx">currentNode</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">,</span> <span class="nx">selector</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">ancestor</span> <span class="o">=</span> <span class="nx">currentNode</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">currentNode</span> <span class="o">=</span> <span class="nx">currentNode</span><span class="p">.</span><span class="nx">parentNode</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nx">ancestor</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">aria</span><span class="p">.</span><span class="nx">Utils</span><span class="p">.</span><span class="nx">hasClass</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">className</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="k">new</span> <span class="nb">RegExp</span><span class="p">(</span><span class="s1">&#39;(\\s|^)&#39;</span> <span class="o">+</span> <span class="nx">className</span> <span class="o">+</span> <span class="s1">&#39;(\\s|$)&#39;</span><span class="p">).</span><span class="nx">test</span><span class="p">(</span><span class="nx">element</span><span class="p">.</span><span class="nx">className</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">aria</span><span class="p">.</span><span class="nx">Utils</span><span class="p">.</span><span class="nx">addClass</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">className</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">aria</span><span class="p">.</span><span class="nx">Utils</span><span class="p">.</span><span class="nx">hasClass</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">className</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">element</span><span class="p">.</span><span class="nx">className</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nx">className</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">aria</span><span class="p">.</span><span class="nx">Utils</span><span class="p">.</span><span class="nx">removeClass</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">className</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kd">var</span> <span class="nx">classRegex</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">RegExp</span><span class="p">(</span><span class="s1">&#39;(\\s|^)&#39;</span> <span class="o">+</span> <span class="nx">className</span> <span class="o">+</span> <span class="s1">&#39;(\\s|$)&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nx">element</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="nx">element</span><span class="p">.</span><span class="nx">className</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">classRegex</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">).</span><span class="nx">trim</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">aria</span><span class="p">.</span><span class="nx">Utils</span><span class="p">.</span><span class="nx">bindMethods</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">object</span> <span class="cm">/* , ...methodNames */</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kd">var</span> <span class="nx">methodNames</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="nx">methodNames</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">method</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">object</span><span class="p">[</span><span class="nx">method</span><span class="p">]</span> <span class="o">=</span> <span class="nx">object</span><span class="p">[</span><span class="nx">method</span><span class="p">].</span><span class="nx">bind</span><span class="p">(</span><span class="nx">object</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span></code></pre></div>
          </section>
     </div>
</main>

	<footer role="contentinfo">
	
	<div class="pied">
		<ul>
			
			<li><a href="mailto:sc.gounon%28a%29gmail.com"  title="Courriel"><i class="fa fa-envelope" aria-hidden="true"></i><span class="sr-only">Courriel</span></a></li>
			
			<li><a href="https://github.com/sofeve-concept"  title="GitHub"><i class="fab fa-github" aria-hidden="true"></i><span class="sr-only">GitHub</span></a></li>
			
			<li><a href="https://www.linkedin.com/in/sophie-gounon/"  title="LinkedIn"><i class="fab fa-linkedin" aria-hidden="true"></i><span class="sr-only">LinkedIn</span></a></li>
			
		</ul>
		<ul>
			
		    <li><a href="/a-propos/" class="">À propos</a></li>
		    
		    <li><a href="/mentions-legales" class="">Mentions légales et crédits</a></li>
		    
		   
		</ul>
		<p class="copyr">&copy; 2023 Sofève Concept - <span>By</span> Sofève Concept</p>
	 </div>
</footer>
<a id="RetourEnHaut" class="cInvisible" href="#top">
	<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"
	    aria-hidden="true">
	    <path
		   d="m7.247 4.86-4.796 5.481c-.566.647-.106 1.659.753 1.659h9.592a1 1 0 0 0 .753-1.659l-4.796-5.48a1 1 0 0 0-1.506 0z" />
	</svg>
	<span class="sr-only">Retour haut de page</span></a>
 <script src="/js/script.js"></script>
 <script src="/js/utils.js"></script>
 
 <script src="/js/clipboard.js"></script>

<script src="/js/search.js"></script>
	

<script src="/js/modale.js"></script>
	

<script>
	sandwitch();
</script>	

</body>
</html>
